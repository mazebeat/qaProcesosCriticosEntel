!function(a){var b=function(d,c){this.$element=a(d),this.options=a.extend({},a.fn.tree.defaults,c),this.$element.on("click",".tree-item",a.proxy(function(e){this.selectItem(e.currentTarget)},this)),this.$element.on("click",".tree-folder-header",a.proxy(function(e){this.selectFolder(e.currentTarget)},this)),this.render()};b.prototype={constructor:b,render:function(){this.populate(this.$element)},populate:function(f){var c=this,g=f.parent(),d=g.find(".tree-loader:eq(0)");d.show(),this.options.dataSource.data(f.data(),function(e){d.hide(),a.each(e.data,function(j,k){var i;"folder"===k.type?(i=c.$element.find(".tree-folder:eq(0)").clone().show(),i.find(".tree-folder-name").html(k.name),i.find(".tree-loader").html(c.options.loadingHTML),i.find(".tree-folder-header").data(k)):"item"===k.type&&(i=c.$element.find(".tree-item:eq(0)").clone().show(),i.find(".tree-item-name").html(k.name),i.data(k));var h=k.dataAttributes||[];a.each(h,function(l,m){switch(l){case"class":case"classes":case"className":i.addClass(m);break;default:i.attr(l,m)}}),f.hasClass("tree-folder-header")?g.find(".tree-folder-content:eq(0)").append(i):f.append(i)}),c.$element.trigger("loaded",g)})},selectItem:function(f){var c=a(f),h=this.$element.find(".tree-selected"),d=[];if(this.options.multiSelect?a.each(h,function(i,k){var j=a(k);j[0]!==c[0]&&d.push(a(k).data())}):h[0]!==c[0]&&(h.removeClass("tree-selected").find("i").removeClass("fa fa-check").addClass("tree-dot"),d.push(c.data())),this.options.selectable){var g="selected";c.hasClass("tree-selected")?(g="unselected",c.removeClass("tree-selected"),c.find("i").removeClass("fa fa-check").addClass("tree-dot")):(c.addClass("tree-selected"),c.find("i").removeClass("tree-dot").addClass("fa fa-check"),this.options.multiSelect&&d.push(c.data()))}d.length&&this.$element.trigger("selected",{info:d}),c.trigger("updated",{info:d,item:c,eventType:g})},selectFolder:function(j){var f,m,h,k=a(j),g=k.parent(),d=g.find(".tree-folder-content"),c=d.eq(0);k.find(".fa.fa-folder").length?(f="opened",m=".fa.fa-folder",h="fa fa-folder-open",c.show(),d.children().length||this.populate(k)):(f="closed",m=".fa.fa-folder-open",h="fa fa-folder",c.hide(),this.options.cacheItems||c.empty()),g.find(m).eq(0).removeClass("fa fa-folder fa-folder-open").addClass(h),this.$element.trigger(f,k.data())},selectedItems:function(){var d=this.$element.find(".tree-selected"),c=[];return a.each(d,function(f,g){c.push(a(g).data())}),c},collapse:function(){var c=this.options.cacheItems;this.$element.find(".fa.fa-folder-open").each(function(){var d=a(this).removeClass("fa fa-folder fa-folder-open").addClass("fa fa-folder"),f=d.parent().parent(),e=f.children(".tree-folder-content");e.hide(),c||e.empty()})}},a.fn.tree=function(c,f){var d,e=this.each(function(){var i=a(this),h=i.data("tree"),g="object"==typeof c&&c;h||i.data("tree",h=new b(this,g)),"string"==typeof c&&(d=h[c](f))});return void 0===d?e:d},a.fn.tree.defaults={selectable:!0,multiSelect:!1,loadingHTML:"<div>Loading...</div>",cacheItems:!0},a.fn.tree.Constructor=b}(window.jQuery);